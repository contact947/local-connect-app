# LocalConnect - プロジェクトTODO

## データベース設計
- [x] ユーザーテーブル設計（名前、年齢、性別、住所、アカウントID）
- [x] ニュース記事テーブル設計（タイトル、本文、カテゴリ、地域、画像URL、投稿日時、アクセス数）
- [x] イベントテーブル設計（タイトル、説明、日時、会場、価格、地域、画像URL）
- [x] チケットテーブル設計（ユーザーID、イベントID、QRコード、使用済みフラグ）
- [x] ギフトテーブル設計（店舗名、特典内容、位置情報、有効期限、利用条件、使用回数制限）
- [x] ギフト使用履歴テーブル設計（ユーザーID、ギフトID、使用日時）

## バックエンドAPI実装
- [x] ユーザー登録・認証API（Manus-OAuth連携）
- [x] ユーザー情報取得・更新API
- [x] ニュース記事一覧取得API（地域フィルター、カテゴリフィルター）
- [x] ニュース記事詳細取得API
- [x] イベント一覧取得API（地域フィルター）
- [x] イベント詳細取得API
- [x] チケット購入API（モック決済）
- [x] チケット一覧取得API（ユーザーの参加予定イベント）
- [x] ギフト一覧取得API（位置情報ベース）
- [x] ギフト使用API（QRコード検証、使用済み更新）

## フロントエンド画面実装
- [x] 認証画面（ログイン・サインアップ）
- [x] ホームタブ画面（地域ニュース・コラム表示）
- [x] ニュースタブ画面（全国ニュース一覧）
- [ ] ニュース詳細画面
- [x] イベントタブ画面（参加予定・地域イベント）
- [ ] イベント詳細画面
- [ ] チケット購入フロー（枚数選択・決済・QRコード発行）
- [ ] QRコード表示画面（チケット・ギフト共通）
- [x] ギフトタブ画面（GPS位置情報ベース一覧）
- [ ] ギフト詳細・使用画面
- [x] アカウント画面（プロフィール表示・編集）

## 機能実装
- [x] QRコード生成機能（react-native-qrcode-svg）
- [x] QRコードスキャン機能（expo-camera）
- [x] GPS位置情報取得機能（expo-location）
- [ ] プッシュ通知機能（expo-notifications）
- [x] ダークモード対応（ThemeProvider実装済み）
- [x] 画像キャッシング（expo-image）

## テスト・動作確認
- [x] 認証フロー動作確認
- [x] 各画面の表示確認
- [x] API連携動作確認
- [x] QRコード生成・読み取り確認
- [x] GPS位置情報取得確認
- [x] ダークモード切り替え確認

## ドキュメント作成
- [x] アプリ全体の構成説明ドキュメント
- [x] ディレクトリ構成説明
- [x] 主要機能のサンプルコード説明
- [x] 今後の拡張アイデア


## フェーズ2: 詳細画面・購入フロー実装

### フェーズ1: 詳細画面の実装
- [x] イベント詳細画面 (app/events/[id].tsx) の作成
- [x] ギフト詳細画面 (app/gifts/[id].tsx) の作成
- [x] リスト画面からの遷移機能の実装
- [x] バックエンドAPI (events.getById, gifts.getById, gifts.checkUsage) の確認・追加

### フェーズ2: 購入フロー・使用フローのUI実装
- [x] チケット購入モーダルの実装
- [x] 枚数選択・合計金額表示機能
- [x] 購入確定処理（tickets.purchase Mutation）
- [x] 購入完了画面の実装
- [x] ギフト使用確認アラートの実装
- [x] ギフト使用処理（gifts.use Mutation）
- [x] QRコード表示画面の統合

### フェーズ3: UX改善
- [x] Pull to Refresh機能の追加（各リスト画面）
- [x] expo-brightness パッケージのインストール
- [x] QRコード表示時の輝度自動調整機能
- [x] ローディング状況の改善
- [x] エラーハンドリングの改善


## フェーズ3: UI微修正と認証画面追加

### フェーズ1: ニュースタブのカテゴリ選択UI修正
- [x] ニュース画面のカテゴリフィルター高さ固定を削除
- [x] ScrollViewにpy-2を追加して最小限のパディングに変更
- [x] contentContainerStyle={{ alignItems: 'center' }}を維持
- [x] カテゴリボタンの上下に無駄な空間がないことを確認

### フェーズ2: ログイン・新規登録画面の追加
- [x] 認証ランディング画面 (app/auth/welcome.tsx) の作成
- [x] アプリロゴ・タイトル・キャッチコピーの配置
- [x] 「アカウントを作成する」ボタンの実装
- [x] 「ログイン」ボタンの実装
- [x] app/(tabs)/account.tsx のログインボタンを遷移に変更
- [x] 他のタブの未ログイン時ログインボタンを遷移に変更
- [x] app/_layout.tsx にルーティング設定を追加


## フェーズ4: Firebase Authentication導入とRBAC実装

### フェーズ1: Firebase Authentication移行
- [ ] Firebase SDKのインストール
- [ ] Firebase Authentication設定
- [ ] 既存Manus-OAuth認証からの移行
- [ ] 初期起動フロー実装（未ログイン時に会員登録画面表示）
- [ ] 会員登録画面の刷新（新規登録フォーム＋ログイン遷移）

### フェーズ2: RBAC権限管理実装
- [ ] Firestore スキーマ更新（role フィールド追加）
- [ ] デフォルト role: "user" の付与ロジック
- [ ] admin/planner/user の権限定義
- [ ] 権限チェック関数の実装

### フェーズ3: ホームタブ構成変更
- [ ] トップニュース表示
- [ ] 参加予定イベント表示
- [ ] 地域ニュース表示
- [ ] 地域イベント表示
- [ ] ユーザー住所ベースのフィルタリング

### フェーズ4: ニュース/イベントタブUI更新
- [ ] セグメントコントロール実装（全国/地域）
- [ ] ニュースタブのセグメント切り替え
- [ ] イベントタブのセグメント切り替え
- [ ] 地域フィルタリングロジック

### フェーズ5: アカウント画面刷新
- [ ] リスト形式UI実装
- [ ] Firebase連携（表示・編集）
- [ ] 表示項目：アカウントID、氏名、年齢、住所、性別、職業
